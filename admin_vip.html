<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Admin VIP Panel</title>

<style>
body {
  margin: 0;
  padding: 16px;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: #0f172a;
  color: #fff;
}

h1 {
  margin-bottom: 16px;
}

.card {
  background: #1e293b;
  border-radius: 14px;
  padding: 14px;
  margin-bottom: 12px;
}

.card div {
  margin-bottom: 6px;
}

button {
  padding: 10px 14px;
  border-radius: 10px;
  border: none;
  font-weight: 700;
  cursor: pointer;
}

.approve {
  background: #22c55e;
  color: #000;
}

.status {
  font-weight: 700;
}

.pending {
  color: #facc15;
}

.approved {
  color: #22c55e;
}
</style>
</head>

<body>

<h1>VIP Requests (Admin)</h1>
<div id="vipList">Loading...</div>

<!-- FIREBASE SDK -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore,
  collection,
  getDocs,
  updateDoc,
  doc,
  serverTimestamp
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* =========================
   FIREBASE CONFIG (YOURS)
   ========================= */
const firebaseConfig = {
  apiKey: "AIzaSyA1HZLZRY9UADNnDVBnoBIlG3b-bCkojxs",
  authDomain: "primeinvestproject2.firebaseapp.com",
  projectId: "primeinvestproject2",
  storageBucket: "primeinvestproject2.firebasestorage.app",
  messagingSenderId: "798977477628",
  appId: "1:798977477628:web:c97d1fba72ad7865864079"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const vipList = document.getElementById("vipList");

/* =========================
   LOAD VIP REQUESTS
   ========================= */
async function loadRequests() {
  vipList.innerHTML = "Loading...";
  const snap = await getDocs(collection(db, "vip_requests"));

  vipList.innerHTML = "";

  if (snap.empty) {
    vipList.innerHTML = "No VIP requests found.";
    return;
  }

  snap.forEach(docSnap => {
    const data = docSnap.data();
    const div = document.createElement("div");
    div.className = "card";

    div.innerHTML = `
      <div><b>User ID:</b> ${data.userId}</div>
      <div><b>VIP Level:</b> ${data.vipLevel}</div>
      <div><b>Price:</b> $${data.price}</div>
      <div>
        <b>Status:</b>
        <span class="status ${data.status}">
          ${data.status}
        </span>
      </div>
      ${
        data.status === "pending"
          ? `<button class="approve">Approve VIP</button>`
          : ""
      }
    `;

    if (data.status === "pending") {
      div.querySelector("button").onclick = async () => {
        await updateDoc(doc(db, "vip_requests", docSnap.id), {
          status: "approved",
          approvedAt: serverTimestamp()
        });
        alert("âœ… VIP Approved");
        loadRequests();
      };
    }

    vipList.appendChild(div);
  });
}

loadRequests();
</script>

</body>
</html>
