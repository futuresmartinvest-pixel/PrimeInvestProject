<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport"
content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
<title>PrimeGlobalPro</title>

<style>
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  color:#fff;
  background:
    radial-gradient(circle at 18% 18%, rgba(165,120,255,.45), transparent 42%),
    radial-gradient(circle at 82% 75%, rgba(0,220,255,.35), transparent 45%),
    radial-gradient(circle at 40% 85%, rgba(255,160,90,.22), transparent 40%),
    linear-gradient(180deg,#05070f,#0a0f24);
  overflow-x:hidden;
}

.wrap{padding:18px 16px 110px; max-width:420px; margin:0 auto;}

.glass{
  background:rgba(255,255,255,0.12);
  border:1px solid rgba(255,255,255,0.22);
  box-shadow:0 18px 50px rgba(0,0,0,.35);
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
  border-radius:24px;
}

.card{padding:18px;text-align:center}
.card .label{opacity:.8;font-weight:600}
.card .amount{font-size:52px;font-weight:900;margin:6px 0 10px}

.vip-pill{
  display:inline-block;
  padding:8px 14px;
  border-radius:999px;
  background:rgba(255,255,255,0.14);
  border:1px solid rgba(255,255,255,0.18);
  font-weight:700;
}

.tap-area{margin:22px auto 10px;display:flex;justify-content:center}
.orb{
  width:min(250px,72vw);
  height:min(250px,72vw);
  border-radius:999px;
  border:1px solid rgba(255,255,255,0.28);
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}
.tap-text{font-weight:900;letter-spacing:2px}

.stats{margin-top:14px;padding:14px 16px}
.row{display:flex;justify-content:space-between;font-weight:700}
.mono{font-variant-numeric:tabular-nums}
</style>
</head>

<body>
<div class="wrap">

<div class="glass card">
  <div class="label">Balance</div>
  <div class="amount mono" id="balanceUsd">$0.00</div>
  <div class="vip-pill" id="vipPill">VIP: None</div>
</div>

<div class="tap-area">
  <div class="orb" id="tapBtn">
    <div class="tap-text">TAP</div>
  </div>
</div>

<div class="glass stats">
  <div class="row"><span>Score</span><b class="mono" id="scoreText">0</b></div>
  <div class="row"><span>Tap power</span><b id="powerText">1×</b></div>
  <div class="row"><span>Today taps</span><b class="mono" id="todayText">0 / 500000</b></div>
  <div class="row"><span>Score → USD</span><b class="mono" id="scoreUsd">$0.00</b></div>
</div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore, doc, getDoc, setDoc, runTransaction, serverTimestamp
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyA1HZLZRY9UADNnDVBnoBIlG3b-bCkojxs",
  authDomain: "primeinvestproject2.firebaseapp.com",
  projectId: "primeinvestproject2",
  storageBucket: "primeinvestproject2.firebasestorage.app",
  messagingSenderId: "798977477628",
  appId: "1:798977477628:web:c97d1fba72ad7865864079"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const SCORE_PER_USD = 10000000;
const NONVIP_DAILY_LIMIT = 500000;

const MULT = {0:1,1:5,2:10,3:20,4:40,5:80,6:800,7:8000,8:80000};

function getOrCreateUserId(){
  let id = localStorage.getItem("userId");
  if(!id){
    id = "user_" + Math.random().toString(36).slice(2) + Date.now();
    localStorage.setItem("userId", id);
  }
  return id;
}

const userId = getOrCreateUserId();
const userRef = doc(db,"users",userId);

function todayKey(){
  const d=new Date();
  return `${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`;
}

const elBalance=document.getElementById("balanceUsd");
const elVip=document.getElementById("vipPill");
const elScore=document.getElementById("scoreText");
const elPower=document.getElementById("powerText");
const elToday=document.getElementById("todayText");
const elScoreUsd=document.getElementById("scoreUsd");
const tapBtn=document.getElementById("tapBtn");

async function ensureUser(){
  const snap=await getDoc(userRef);
  if(!snap.exists()){
    await setDoc(userRef,{
      balance:0,
      score:0,
      tapsToday:0,
      tapsDate:todayKey(),
      createdAt:serverTimestamp()
    });
  }
}

async function refreshUI(){
  const snap=await getDoc(userRef);
  if(!snap.exists()) return;
  const u=snap.data()||{};

  const vip=u.vip?.level||0;
  const power=MULT[vip]||1;

  const score=Number.isFinite(u.score)?u.score:0;
  const tapsToday=Number.isFinite(u.tapsToday)?u.tapsToday:0;
  const usd=score/SCORE_PER_USD;

  elVip.textContent=vip?`VIP: ${vip}`:"VIP: None";
  elPower.textContent=power+"×";
  elScore.textContent=Math.floor(score);
  elToday.textContent=`${tapsToday} / ${vip? "∞":NONVIP_DAILY_LIMIT}`;
  elScoreUsd.textContent="$"+usd.toFixed(2);
  elBalance.textContent="$"+(usd+(u.balance||0)).toFixed(2);
}

async function tap(){
  const tk=todayKey();
  await runTransaction(db,async(tx)=>{
    const snap=await tx.get(userRef);
    const u=snap.exists()?snap.data():{};
    const vip=u.vip?.level||0;
    const power=MULT[vip]||1;

    let tapsToday=Number.isFinite(u.tapsToday)?u.tapsToday:0;
    let tapsDate=u.tapsDate||tk;
    if(tapsDate!==tk){tapsToday=0;tapsDate=tk;}

    if(vip===0 && tapsToday>=NONVIP_DAILY_LIMIT)
      throw new Error("Daily limit reached");

    tx.set(userRef,{
      score:(u.score||0)+power,
      tapsToday:tapsToday+1,
      tapsDate
    },{merge:true});
  });
  refreshUI();
}

tapBtn.addEventListener("click",()=>tap().catch(e=>alert(e.message)));

await ensureUser();
await refreshUI();
</script>
</body>
</html>
