<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport"
content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<title>PrimeGlobalPro</title>

<style>
body{
  margin:0;
  font-family:system-ui;
  background:linear-gradient(135deg,#5b2fc2,#7c3aed);
  color:#fff;
  text-align:center;
  overflow:hidden;
}

/* GLASS */
.glass{
  margin:20px;
  padding:20px;
  border-radius:24px;
  background:rgba(255,255,255,.15);
  backdrop-filter:blur(18px);
}

.balance{
  font-size:38px;
  font-weight:900;
}

.vip{
  margin-top:6px;
  font-size:14px;
  font-weight:800;
  background:linear-gradient(135deg,#facc15,#f59e0b);
  color:#000;
  padding:6px 14px;
  border-radius:999px;
  display:inline-block;
}

/* ROBOT */
.robot-wrap{
  margin-top:28px;
  display:flex;
  justify-content:center;
  position:relative;
}

.robot{
  width:190px;
  height:190px;
  border-radius:50%;
  background:radial-gradient(circle,#fff,#cbd5f5);
  font-size:92px;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  animation:float 4s ease-in-out infinite;
  transition:transform .08s, box-shadow .08s;
}

.robot.tap{
  transform:scale(.9);
  box-shadow:0 0 60px rgba(255,255,255,.9);
}

@keyframes float{
  0%{transform:translateY(0)}
  50%{transform:translateY(-14px)}
  100%{transform:translateY(0)}
}

/* PARTICLES */
.particle{
  position:absolute;
  width:8px;
  height:8px;
  border-radius:50%;
  animation:fly .7s forwards;
}

@keyframes fly{
  to{
    transform:translate(var(--x),var(--y)) scale(0);
    opacity:0;
  }
}

/* SCORE */
.score{
  margin-top:14px;
  font-weight:700;
}

/* NAV (ICONS ONLY) */
.nav{
  position:fixed;
  bottom:14px;
  left:14px;
  right:14px;
  background:rgba(255,255,255,.92);
  backdrop-filter:blur(16px);
  display:flex;
  justify-content:space-around;
  padding:14px 0;
  border-radius:28px;
  box-shadow:0 10px 30px rgba(0,0,0,.25);
}

.nav div{
  font-size:22px;
  cursor:pointer;
}
</style>
</head>

<body>

<!-- TOP -->
<div class="glass">
  <div class="balance" id="balance">$0.00</div>
  <div class="vip" id="vipBadge">NO VIP</div>
</div>

<!-- ROBOT -->
<div class="robot-wrap" id="wrap">
  <div class="robot" id="bot">ü§ñ</div>
</div>

<div class="score">
  Today score: <span id="score">0</span>
</div>

<!-- NAV ICONS -->
<div class="nav">
  <div>üè†</div>
  <div onclick="location.href='tasks.html'">üìã</div>
  <div onclick="location.href='wallet.html'">üíº</div>
  <div onclick="location.href='referral.html'">üë•</div>
  <div onclick="location.href='deposit.html'">üíé</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore,
  doc,
  getDoc,
  setDoc,
  updateDoc,
  serverTimestamp
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* FIREBASE */
const firebaseConfig = {
  apiKey: "AIzaSyA1HZLZRY9UADNnDVBnoBIlG3b-bCkojxs",
  authDomain: "primeinvestproject2.firebaseapp.com",
  projectId: "primeinvestproject2",
  storageBucket: "primeinvestproject2.firebasestorage.app",
  messagingSenderId: "798977477628",
  appId: "1:798977477628:web:c97d1fba72ad7865864079"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* CONSTANTS */
const SCORE_TO_USD = 10000000;
const DAILY_LIMIT = 500000;
const MULTI = {0:1,1:5,2:10,3:20,4:40,5:80,6:800,7:8000,8:80000};
const TAP_DELAY = 120;

/* USER ID */
function uid(){
  let id = localStorage.getItem("uid");
  if(!id){
    id="user_"+Date.now()+"_"+Math.random().toString(36).slice(2,8);
    localStorage.setItem("uid",id);
  }
  return id;
}
const ref = doc(db,"users",uid());

let user;
let today = new Date().toISOString().slice(0,10);
let lastTap = 0;

/* SOUND */
const audio = new Audio("data:audio/wav;base64,UklGRhQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YRAAAA==");

/* INIT */
async function init(){
  const snap = await getDoc(ref);
  if(!snap.exists()){
    await setDoc(ref,{
      balance:0,
      score:{},
      createdAt:serverTimestamp(),
      withdrawLocked:true   // üîí withdrawal rule
    });
  }
  user=(await getDoc(ref)).data();
  render();
}

/* UI */
function render(){
  balance.innerText="$"+(user.balance||0).toFixed(2);
  const lvl=user.vip?.level||0;
  vipBadge.innerText=lvl?`VIP ${lvl} √ó${MULTI[lvl]}`:"NO VIP";
  score.innerText=user.score?.[today]||0;
}

/* PARTICLES */
function sparks(x,y){
  for(let i=0;i<6;i++){
    const p=document.createElement("div");
    p.className="particle";
    p.style.left=x+"px";
    p.style.top=y+"px";
    p.style.background=`hsl(${Math.random()*60+40},100%,60%)`;
    p.style.setProperty("--x",(Math.random()*100-50)+"px");
    p.style.setProperty("--y",(Math.random()*100-50)+"px");
    wrap.appendChild(p);
    setTimeout(()=>p.remove(),700);
  }
}

/* TAP (ANTI-BOT + LIMIT) */
bot.onclick=async(e)=>{
  const now=Date.now();
  if(now-lastTap<TAP_DELAY) return;     // anti-bot
  lastTap=now;

  bot.classList.add("tap");
  setTimeout(()=>bot.classList.remove("tap"),90);

  audio.currentTime=0; audio.play();
  navigator.vibrate?.(25);

  sparks(e.clientX,e.clientY);

  const lvl=user.vip?.level||0;
  const mult=MULTI[lvl];

  user.score ||= {};
  user.score[today] ||= 0;

  if(lvl===0 && user.score[today]>=DAILY_LIMIT){
    alert("Daily tap limit reached");
    return;
  }

  user.score[today]+=mult;
  user.balance=(user.balance||0)+(mult/SCORE_TO_USD);

  await updateDoc(ref,{
    score:user.score,
    balance:user.balance
  });

  render();
};

init();
</script>

</body>
</html>
